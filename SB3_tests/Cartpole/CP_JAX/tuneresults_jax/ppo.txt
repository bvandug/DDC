Tuning A2C on JAX env with SB3...
[I 2025-07-15 17:27:04,314] A new study created in RDB with name: jax_a2c_tuning
Tuning A2C:   0%|                                                                                                                                                                                    | 0/50 [00:00<?, ?it/s]C:\Users\benva\OneDrive\Documents\MATLAB\myenv\Lib\site-packages\stable_baselines3\common\on_policy_algorithm.py:150: UserWarning: You are trying to run A2C on the GPU, but it is primarily intended to run on the CPU when not using a CNN policy (you are using ActorCriticPolicy which should be a MlpPolicy). See https://github.com/DLR-RM/stable-baselines3/issues/1245 for more info. You can pass `device='cpu'` or `export CUDA_VISIBLE_DEVICES=` to force using the CPU.Note: The model will train, but the GPU utilization will be poor and the training might take longer than on CPU.
  warnings.warn(
[I 2025-07-15 17:29:10,593] Trial 2 pruned. 
Tuning A2C:   2%|███▏                                                                                                                                                         | 1/50 [02:06<1:43:07, 126.28s/it, best_val=–][I 2025-07-15 17:29:30,048] Trial 3 pruned.
Tuning A2C:   4%|██████▍                                                                                                                                                         | 2/50 [02:25<50:45, 63.44s/it, best_val=–][I 2025-07-15 17:29:32,381] Trial 0 pruned.
Tuning A2C:   6%|█████████▌                                                                                                                                                      | 3/50 [02:28<27:50, 35.54s/it, best_val=–][I 2025-07-15 17:31:12,661] Trial 4 pruned.
Tuning A2C:   8%|████████████▊                                                                                                                                                   | 4/50 [04:08<46:50, 61.10s/it, best_val=–][I 2025-07-15 17:31:31,726] Trial 5 pruned.
Tuning A2C:  10%|████████████████                                                                                                                                                | 5/50 [04:27<34:27, 45.94s/it, best_val=–][I 2025-07-15 17:31:45,797] Trial 6 pruned.
Tuning A2C:  12%|███████████████████▏                                                                                                                                            | 6/50 [04:41<25:44, 35.10s/it, best_val=–][I 2025-07-15 17:33:40,476] Trial 8 pruned.
Tuning A2C:  14%|██████████████████████▍                                                                                                                                         | 7/50 [06:36<43:48, 61.12s/it, best_val=–][I 2025-07-15 17:33:45,108] Trial 7 pruned.
Tuning A2C:  16%|█████████████████████████▌                                                                                                                                      | 8/50 [06:40<30:11, 43.14s/it, best_val=–][I 2025-07-15 17:33:53,905] Trial 1 finished with value: 475.94989013671875 and parameters: {'learning_rate': 0.0008375746457336468, 'gamma': 0.916304897710307, 'n_steps': 28, 'ent_coef': 4.56221124719437e-05, 'vf_coef': 0.8021105110956395, 'max_grad_norm': 3.266456434621582, 'rms_prop_eps': 0.0009249623117345998, 'use_rms_prop': True, 'layer_size': 34, 'n_layers': 3, 'activation_fn': 'relu'}. Best is trial 1 with value: 475.94989013671875.
Tuning A2C:  18%|████████████████████████████                                                                                                                                | 9/50 [06:49<22:08, 32.40s/it, best_val=475.9][I 2025-07-15 17:34:10,725] Trial 9 pruned.
Tuning A2C:  20%|███████████████████████████████                                                                                                                            | 10/50 [07:06<18:23, 27.59s/it, best_val=475.9][I 2025-07-15 17:36:05,969] Trial 10 pruned.
Tuning A2C:  22%|██████████████████████████████████                                                                                                                         | 11/50 [09:01<35:22, 54.42s/it, best_val=475.9][I 2025-07-15 17:36:08,836] Trial 12 pruned.
Tuning A2C:  24%|█████████████████████████████████████▏                                                                                                                     | 12/50 [09:04<24:32, 38.74s/it, best_val=475.9][I 2025-07-15 17:36:21,528] Trial 11 pruned.
Tuning A2C:  26%|████████████████████████████████████████▎                                                                                                                  | 13/50 [09:17<19:01, 30.85s/it, best_val=475.9][I 2025-07-15 17:38:05,339] Trial 13 pruned.
Tuning A2C:  28%|███████████████████████████████████████████▍                                                                                                               | 14/50 [11:01<31:43, 52.88s/it, best_val=475.9][I 2025-07-15 17:38:17,214] Trial 14 pruned.
Tuning A2C:  30%|██████████████████████████████████████████████▌                                                                                                            | 15/50 [11:12<23:38, 40.52s/it, best_val=475.9][I 2025-07-15 17:38:31,702] Trial 16 pruned.
Tuning A2C:  32%|█████████████████████████████████████████████████▌                                                                                                         | 16/50 [11:27<18:31, 32.69s/it, best_val=475.9][I 2025-07-15 17:38:44,032] Trial 15 pruned.
Tuning A2C:  34%|████████████████████████████████████████████████████▋                                                                                                      | 17/50 [11:39<14:36, 26.57s/it, best_val=475.9][I 2025-07-15 17:40:39,561] Trial 17 pruned.
Tuning A2C:  36%|███████████████████████████████████████████████████████▊                                                                                                   | 18/50 [13:35<28:25, 53.30s/it, best_val=475.9][I 2025-07-15 17:42:21,686] Trial 18 pruned.
Tuning A2C:  38%|██████████████████████████████████████████████████████████▉                                                                                                | 19/50 [15:17<35:06, 67.96s/it, best_val=475.9][I 2025-07-15 17:44:40,949] Trial 20 pruned.
Tuning A2C:  40%|██████████████████████████████████████████████████████████████                                                                                             | 20/50 [17:36<44:41, 89.37s/it, best_val=475.9][I 2025-07-15 17:46:13,213] Trial 19 finished with value: 483.697998046875 and parameters: {'learning_rate': 0.00046931303886527527, 'gamma': 0.9167484889206575, 'n_steps': 24, 'ent_coef': 0.07443445425078939, 'vf_coef': 0.7405096817018997, 'max_grad_norm': 4.356740894279867, 'rms_prop_eps': 0.00044904582785901004, 'use_rms_prop': True, 'layer_size': 138, 'n_layers': 4, 'activation_fn': 'relu'}. Best is trial 19 with value: 483.697998046875.
Tuning A2C:  42%|█████████████████████████████████████████████████████████████████                                                                                          | 21/50 [19:08<43:36, 90.24s/it, best_val=483.7][I 2025-07-15 17:47:56,719] Trial 21 finished with value: 495.7736511230469 and parameters: {'learning_rate': 0.0005019352251534891, 'gamma': 0.9180570275377912, 'n_steps': 21, 'ent_coef': 0.0515017817114919, 'vf_coef': 0.7077429620234892, 'max_grad_norm': 3.0567710189618653, 'rms_prop_eps': 0.0003612639347324675, 'use_rms_prop': True, 'layer_size': 146, 'n_layers': 3, 'activation_fn': 'relu'}. Best is trial 21 with value: 495.7736511230469.
Tuning A2C:  44%|████████████████████████████████████████████████████████████████████▏                                                                                      | 22/50 [20:52<43:58, 94.22s/it, best_val=495.8][I 2025-07-15 17:50:54,437] Trial 22 finished with value: 493.1700134277344 and parameters: {'learning_rate': 0.0005014499004728296, 'gamma': 0.9168516459872914, 'n_steps': 9, 'ent_coef': 0.0005543225554134246, 'vf_coef': 0.4561199244975805, 'max_grad_norm': 0.7281955098407358, 'rms_prop_eps': 0.0004133004211093881, 'use_rms_prop': True, 'layer_size': 147, 'n_layers': 3, 'activation_fn': 'relu'}. Best is trial 21 with value: 495.7736511230469.
Tuning A2C:  46%|██████████████████████████████████████████████████████████████████████▊                                                                                   | 23/50 [23:50<53:40, 119.28s/it, best_val=495.8][I 2025-07-15 17:51:28,458] Trial 23 pruned.
Tuning A2C:  48%|██████████████████████████████████████████████████████████████████████████▍                                                                                | 24/50 [24:24<40:36, 93.69s/it, best_val=495.8][I 2025-07-15 17:54:46,542] Trial 25 pruned.
Tuning A2C:  50%|█████████████████████████████████████████████████████████████████████████████                                                                             | 25/50 [27:42<52:05, 125.02s/it, best_val=495.8][I 2025-07-15 17:54:47,985] Trial 24 finished with value: 497.82672119140625 and parameters: {'learning_rate': 0.0004354110248862673, 'gamma': 0.9175572060900082, 'n_steps': 9, 'ent_coef': 0.0007279109251865605, 'vf_coef': 0.9018228958103324, 'max_grad_norm': 0.354601567320692, 'rms_prop_eps': 0.0004252350571325498, 'use_rms_prop': True, 'layer_size': 138, 'n_layers': 3, 'activation_fn': 'relu'}. Best is trial 24 with value: 497.82672119140625.
Tuning A2C:  52%|████████████████████████████████████████████████████████████████████████████████▌                                                                          | 26/50 [27:43<35:10, 87.94s/it, best_val=497.8][I 2025-07-15 17:57:44,392] Trial 29 pruned.
Tuning A2C:  54%|███████████████████████████████████████████████████████████████████████████████████▏                                                                      | 27/50 [30:40<43:53, 114.48s/it, best_val=497.8][I 2025-07-15 17:57:53,624] Trial 27 pruned.
Tuning A2C:  56%|██████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 28/50 [30:49<30:23, 82.91s/it, best_val=497.8][I 2025-07-15 17:58:06,370] Trial 26 pruned.
Tuning A2C:  58%|█████████████████████████████████████████████████████████████████████████████████████████▉                                                                 | 29/50 [31:02<21:39, 61.86s/it, best_val=497.8][I 2025-07-15 18:00:52,754] Trial 28 pruned.
Tuning A2C:  60%|█████████████████████████████████████████████████████████████████████████████████████████████                                                              | 30/50 [33:48<31:04, 93.22s/it, best_val=497.8][I 2025-07-15 18:05:25,453] Trial 32 finished with value: 497.23419189453125 and parameters: {'learning_rate': 0.0006454008608860434, 'gamma': 0.9277686271031943, 'n_steps': 14, 'ent_coef': 0.00022137315947971022, 'vf_coef': 0.8816269213359267, 'max_grad_norm': 0.5388675857179958, 'rms_prop_eps': 3.911221425661189e-05, 'use_rms_prop': False, 'layer_size': 98, 'n_layers': 2, 'activation_fn': 'tanh'}. Best is trial 24 with value: 497.82672119140625.
Tuning A2C:  62%|███████████████████████████████████████████████████████████████████████████████████████████████▍                                                          | 31/50 [38:21<46:34, 147.06s/it, best_val=497.8][I 2025-07-15 18:05:46,891] Trial 30 finished with value: 496.7959899902344 and parameters: {'learning_rate': 0.00033787848144371726, 'gamma': 0.9396724573046684, 'n_steps': 15, 'ent_coef': 0.00023287435356800126, 'vf_coef': 0.8786683322445774, 'max_grad_norm': 0.31529105126537615, 'rms_prop_eps': 5.560299180316555e-05, 'use_rms_prop': True, 'layer_size': 251, 'n_layers': 3, 'activation_fn': 'relu'}. Best is trial 24 with value: 497.82672119140625.
Tuning A2C:  64%|██████████████████████████████████████████████████████████████████████████████████████████████████▌                                                       | 32/50 [38:42<32:48, 109.37s/it, best_val=497.8][I 2025-07-15 18:05:58,913] Trial 31 finished with value: 498.4129638671875 and parameters: {'learning_rate': 0.0006883833607584897, 'gamma': 0.9445410736076584, 'n_steps': 15, 'ent_coef': 0.0003052281702040743, 'vf_coef': 0.8699550159152042, 'max_grad_norm': 0.5212539909835572, 'rms_prop_eps': 5.2076121455428655e-05, 'use_rms_prop': True, 'layer_size': 89, 'n_layers': 3, 'activation_fn': 'tanh'}. Best is trial 31 with value: 498.4129638671875.
Tuning A2C:  66%|██████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                    | 33/50 [38:54<22:42, 80.17s/it, best_val=498.4][I 2025-07-15 18:08:03,756] Trial 35 pruned.
Tuning A2C:  68%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                 | 34/50 [40:59<24:57, 93.57s/it, best_val=498.4][I 2025-07-15 18:08:15,848] Trial 36 pruned.
Tuning A2C:  70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                              | 35/50 [41:11<17:16, 69.13s/it, best_val=498.4][I 2025-07-15 18:08:35,497] Trial 33 finished with value: 498.25701904296875 and parameters: {'learning_rate': 0.0006304705186162375, 'gamma': 0.9269047013818593, 'n_steps': 13, 'ent_coef': 1.8250524514248752e-05, 'vf_coef': 0.890106365028178, 'max_grad_norm': 0.3054373805532516, 'rms_prop_eps': 4.754222510759517e-05, 'use_rms_prop': False, 'layer_size': 177, 'n_layers': 2, 'activation_fn': 'tanh'}. Best is trial 31 with value: 498.4129638671875.
Tuning A2C:  72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 36/50 [41:31<12:39, 54.28s/it, best_val=498.4][I 2025-07-15 18:12:52,486] Trial 34 finished with value: 495.8265380859375 and parameters: {'learning_rate': 0.0006802243559854017, 'gamma': 0.9261723866752568, 'n_steps': 13, 'ent_coef': 0.0023510939337233454, 'vf_coef': 0.8863116934886067, 'max_grad_norm': 0.332649034752003, 'rms_prop_eps': 3.292170035344995e-05, 'use_rms_prop': False, 'layer_size': 87, 'n_layers': 2, 'activation_fn': 'tanh'}. Best is trial 31 with value: 498.4129638671875.
Tuning A2C:  74%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                        | 37/50 [45:48<24:56, 115.10s/it, best_val=498.4][I 2025-07-15 18:13:47,118] Trial 39 pruned.
Tuning A2C:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                     | 38/50 [46:42<19:23, 96.96s/it, best_val=498.4][I 2025-07-15 18:13:59,770] Trial 37 pruned.
Tuning A2C:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                  | 39/50 [46:55<13:08, 71.66s/it, best_val=498.4][I 2025-07-15 18:15:00,331] Trial 40 pruned.
Tuning A2C:  80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                               | 40/50 [47:56<11:23, 68.33s/it, best_val=498.4][I 2025-07-15 18:15:51,964] Trial 41 pruned.
Tuning A2C:  82%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                            | 41/50 [48:47<09:29, 63.32s/it, best_val=498.4][I 2025-07-15 18:16:07,285] Trial 38 finished with value: 498.7799987792969 and parameters: {'learning_rate': 0.000724537138227862, 'gamma': 0.9603634041820946, 'n_steps': 13, 'ent_coef': 1.2342431552736383e-05, 'vf_coef': 0.946354375476943, 'max_grad_norm': 1.1766607760173047, 'rms_prop_eps': 2.2664156518477322e-05, 'use_rms_prop': False, 'layer_size': 315, 'n_layers': 2, 'activation_fn': 'tanh'}. Best is trial 38 with value: 498.7799987792969.
Tuning A2C:  84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 42/50 [49:02<06:31, 48.92s/it, best_val=498.8][I 2025-07-15 18:16:10,182] Trial 42 pruned.
Tuning A2C:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                     | 43/50 [49:05<04:05, 35.11s/it, best_val=498.8][I 2025-07-15 18:17:11,320] Trial 43 pruned.
Tuning A2C:  88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                  | 44/50 [50:07<04:17, 42.92s/it, best_val=498.8][I 2025-07-15 18:18:14,747] Trial 45 pruned.
Tuning A2C:  90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌               | 45/50 [51:10<04:05, 49.07s/it, best_val=498.8][I 2025-07-15 18:18:15,874] Trial 46 pruned.
Tuning A2C:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 46/50 [51:11<02:18, 34.69s/it, best_val=498.8][I 2025-07-15 18:19:17,043] Trial 47 pruned.
Tuning A2C:  94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋         | 47/50 [52:12<02:07, 42.63s/it, best_val=498.8][I 2025-07-15 18:19:58,919] Trial 48 pruned.
Tuning A2C:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 48/50 [52:54<01:24, 42.41s/it, best_val=498.8][I 2025-07-15 18:19:59,954] Trial 49 pruned.
Tuning A2C:  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 49/50 [52:55<00:29, 30.00s/it, best_val=498.8][I 2025-07-15 18:20:52,786] Trial 44 finished with value: 498.6164245605469 and parameters: {'learning_rate': 0.00029949058762658153, 'gamma': 0.9458528467495969, 'n_steps': 19, 'ent_coef': 0.00022519340958569178, 'vf_coef': 0.8385072128551389, 'max_grad_norm': 0.6634968460126895, 'rms_prop_eps': 5.5612103687716665e-05, 'use_rms_prop': False, 'layer_size': 235, 'n_layers': 3, 'activation_fn': 'tanh'}. Best is trial 38 with value: 498.7799987792969.
Tuning A2C: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [53:48<00:00, 64.57s/it, best_val=498.8]
Best reward: 498.78
  learning_rate: 0.000724537138227862
  gamma: 0.9603634041820946
  n_steps: 13
  ent_coef: 1.2342431552736383e-05
  vf_coef: 0.946354375476943
  max_grad_norm: 1.1766607760173047
  rms_prop_eps: 2.2664156518477322e-05
  use_rms_prop: False
  layer_size: 315
  n_layers: 2
  activation_fn: tanh